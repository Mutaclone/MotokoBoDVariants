<!DOCTYPE html>
<html>
<head>
    <title>BoD Nightfury Uploader</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0d1117; color: #c9d1d9; display: flex; justify-content: center; padding: 40px; }
        .box { background: #161b22; border: 1px solid #30363d; padding: 25px; border-radius: 10px; width: 350px; }
        input { width: 100%; margin: 10px 0; padding: 8px; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: #238636; border: none; color: white; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #2ea043; }
        .info { font-size: 12px; color: #8b949e; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="box">
        <h3>Nightfury Variant Portal</h3>
        <input type="password" id="portalPass" placeholder="Portal Password">
        <input type="number" id="vNum" placeholder="Variant Number (e.g. 5)">
        <input type="file" id="vFile" accept="image/png">
        <button onclick="sendDispatch()">Upload to Library</button>
        <div id="status" class="info"></div>
    </div>

    <script>
        async function sendDispatch() {
            const pass = document.getElementById('portalPass').value;
            const num = document.getElementById('vNum').value;
            const file = document.getElementById('vFile').files[0];
            const status = document.getElementById('status');

            if(pass !== "CHANGE_THIS_TO_YOUR_FRIENDS_PASS") return alert("Wrong Password");
            if(!num || !file) return alert("Missing file or number");

            status.innerText = "Encoding image...";
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = async () => {
                const base64 = reader.result.split(',')[1];
                
                status.innerText = "Sending to GitHub Actions...";
                const res = await fetch("https://api.github.com/repos/Mutaclone/MotokoBoDVariants/dispatches", {
                    method: "POST",
                    headers: {
                        "Authorization": "token YOUR_LIMITED_DISPATCH_TOKEN",
                        "Accept": "application/vnd.github.v3+json"
                    },
                    body: JSON.stringify({
                        event_type: "upload_variant",
                        client_payload: { variant: num, file_data: base64 }
                    })
                });

                if(res.ok) status.innerText = "üöÄ Request sent! It will appear in the repo and on the server in ~2 minutes.";
                else status.innerText = "‚ùå Failed. Check console for details.";
            };
        }
    </script>
</body>
</html>
